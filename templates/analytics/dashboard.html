{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="card p-4 mb-4">
    <div class="d-flex justify-content-between align-items-center">
        <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–¥–∞—á</h2>
        <a href="{% url 'tasks:list' %}" class="btn btn-outline-primary btn-sm">
            ‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞—á–∞–º
        </a>
    </div>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <h6>–í—Å–µ–≥–æ</h6>
                <h3>{{ stats.total }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h6>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</h6>
                <h3>{{ stats.completed }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-dark">
            <div class="card-body">
                <h6>–í —Ä–∞–±–æ—Ç–µ</h6>
                <h3>{{ stats.in_progress }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-danger text-white">
            <div class="card-body">
                <h6>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</h6>
                <h3>{{ stats.overdue }}</h3>
            </div>
        </div>
    </div>
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫ -->
<div class="card p-4">
    <h4>üìÖ –ó–∞–¥–∞—á–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é</h4>
    <canvas id="weeklyChart" height="100"></canvas>
</div>
{% endblock %}

{% block extra_js %}
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö -->
    <script>
        const labels = JSON.parse('{{ weekly_labels|safe }}');
        const data = JSON.parse('{{ weekly_data|safe }}');

        document.addEventListener('DOMContentLoaded', function () {
            const ctx = document.getElementById('weeklyChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '–°–æ–∑–¥–∞–Ω–æ –∑–∞–¥–∞—á',
                        data: data,
                        borderColor: '#0d6efd',
                        backgroundColor: 'rgba(13, 110, 253, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        });
    </script>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π JS -->
    <script src="{% static 'js/main.js' %}"></script>
{% endblock %}